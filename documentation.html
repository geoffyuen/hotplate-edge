<!DOCTYPE html>
<html lang="en" class="bg-dark-gray">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Tachyons Explorer</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
    <style>
        html, button, input, optgroup, select, textarea {
            font-family: Montserrat, sans-serif;
        }
        pre {
            tab-size:2;
            /* overflow-wrap: break-word;
            word-break: break-all; */
            font-family: menlo, monospace;
        }
    </style>
</head>

<body>


    <div class="flex-m flex-l">

        <!--  -->
        <div class="w-100 w-25-m w-25-l bg-white shadow-2 top-0 min-vh-100-m min-vh-100-l">
            <div class="sticky top-0">
                <div class="bg-blue pa4">
                    <h1 class="mt0 mb4 lh-solid white fw3 f1">Tachyons Explorer</h1>
                    <div class="mb4 flex flex-wrap">
                        <div class="w-100 flex">
                            <input list="suggestions" id="filter" type="text" class="filter w-100 pv3 ph3 f3 bw0 lh-solid"
                                placeholder="Type a Tachyons class or css rule. Click the card title to copy to clipboard.">
                            <datalist id="suggestions">
                                <option value="flexbox align- justify-">
                                <option value="\s+width:">
                                <option value="\s+min-width:">
                                <option value="\s+height:">
                                <option value="\s+display:">
                                <option value="\s+min-height:">
                                <option value="\s+position: \s+top: \s+left: \s+right: \s+bottom:">
                                <option value="{\s+color:">
                                <option value="\.bg-">
                            </datalist>
                            <button id="clear" class="input-reset pv0 ph3 bw0 bg-light-gray lh-solid hover-bg-black hover-white f1">Ã—</button>
                        </div>
                        <div id="csscontainer" class="pt4 w-100 dn db-m db-l">
                            <label><input type="radio" name="css" value="#outer" checked> Outer</label>
                            <label class="ml4"><input id="cssinner" type="radio" name="css" value="#inner"> Inner</label>
                        </div>
                    </div>
                </div>
                <div class="pa4 dn db-m db-l f4">
                    <div id="outer" class="" style="position: sticky; top 0;">
                        <div id="inner" class="">Lorem ipsum dolor sit amet consectetur adipisicing elit. Tempore,
                            quas. Commodi cum sint maiores impedit, perspiciatis excepturi quod rem beatae dicta
                            temporibus ea assumenda minus necessitatibus sed iste nesciunt ullam!</div>
                    </div>
                </div>
            </div>
        </div>

        <!--  -->
        <div id="rules" class="w-100 w-75-m w-75-l flex flex-wrap f4 pa4"></div>

    </div>


    <template id="template">
        <div class="card flex-auto w-100 w-50-m w-50-l pa4 ">

            <div class="flex flex-column shadow-2 br3 h-100 overflow-hidden">

                <h3 class="ma0 pv3 ph4 bg-dark-blue light-blue pointer hover-blue flex items-center justify-between"
                    data-clipboard-text="">title</h3>

                <pre class="overflow-x-auto flex-auto light-green bg-navy ma0 pv3 ph4">code</pre>

            </div>

        </div>
    </template>


    <div id="alert" class="dn fixed pv2 ph4 bg-green white b br3" style="top: 50%; left: 50%; transform: translate(-50%, -50%)">Copied!</div>

    <!-- ======== End body content ======== -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js"></script>
    <script>
        var
            $rules = $('#rules'),
            $template = $($('#template').prop('content'))
            ;
        Array.prototype.forEach.call(document.styleSheets[0].cssRules, function (a) {
            // console.log(a.selectorText);
            var
                rule = GetStyle(a.selectorText),
                text = a.selectorText + ''
                ;
            text = text.split(' ')[0].split(':')[0].replace('.', '').replace(',', '');
            if (rule.startsWith('.')) {
                rule = rule.replace(/{/g, '{\n\t').replace(/;/g, ';\n\t').replace(/\t }/g, '}');
                $template.find('h3').attr('data-clipboard-text', text).text(text);
                $template.find('pre').text(rule);
                if (rule.startsWith('.bg-')) {
                    $template.find('h3').append('<span class="dib w1 h1 ml1 ' + text + '"></span>')
                }
                if (rule.match(/\s+color/g)) {
                    $template.find('h3').append('<span class="' + text + '">Tt</span>')
                }
                $rules.append($('#template').html());
            }
        });

        function GetStyle(CLASSname) {
            var
                styleSheets = document.styleSheets,
                styleSheetsLength = styleSheets.length
                ;
            for (var i = 0; i < styleSheetsLength; i++) {
                if (styleSheets[i].rules) { var classes = styleSheets[i].rules; }
                else {
                    try { if (!styleSheets[i].cssRules) { continue; } }
                    //Note that SecurityError exception is specific to Firefox.
                    catch (e) { if (e.name == 'SecurityError') { console.log("SecurityError. Cant readd: " + styleSheets[i].href); continue; } }
                    var classes = styleSheets[i].cssRules;
                }
                for (var x = 0; x < classes.length; x++) {
                    if (classes[x].selectorText == CLASSname) {
                        var ret = (classes[x].cssText) ? classes[x].cssText : classes[x].style.cssText;
                        if (ret.indexOf(classes[x].selectorText) == -1) { ret = classes[x].selectorText + "{" + ret + "}"; }
                        return ret;
                    }
                }
            }
        }

        $("#filter").keyup(function () {
            var filter = $(this).val().trim().replace(/ /g, '|');
            //console.log(filter);
            $("#rules .card").each(function () {
                var $this = $(this);
                if (($this.text()).match(new RegExp(filter, 'g'))) {
                    $this.css({ 'display': 'block' });
                } else {
                    $this.css({ 'display': 'none' });
                }
            });
        });
        $('#clear').click(function () {
            $('#filter').val('').focus().trigger('keyup');
        });

        var clipboard = new ClipboardJS('#rules h3');
        clipboard.on('success', function (e) {
            //console.info('Action:', e.action);
            //console.info('Text:', e.text);
            //console.info('Trigger:', e.trigger);
            e.clearSelection();
            $('#alert').text(e.text + ' copied!').fadeIn(200, function () {
                $(this).fadeOut(1000);
            });

            $($('input[name="css"]:checked').val()).toggleClass(e.text);
        });

    </script>
</body>

</html>